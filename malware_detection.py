# Import hashlib library
# Learn more here --> https://docs.python.org/3/library/hashlib.html
import hashlib

# Example signature for flagged/blacklisted hashes that will immeditely activate the system.
malicious_signatures = []

##############################################################################
# Calculate Hash function:
# Input --> file_path
# Output --> Hexicode hash for the file
def calculate_hash(file_path):

  # With is a context manager
  # Open() --> opens the input file from the function with read rights.
  # as file --> Gives the file_path a variable names 'file'
  with open(file_path, 'rb') as file:

    # Read the file content and place the information into the variable
    # named 'file_content'
    file_content = file.read()

  # Return --> provides the called function/variable the output of the
  # function
  # hashlib.md5 --> creates an md5 hash object
  # .md5(file_content) --> input the file_content information into an 
  # md5 hash for a file-specific hash
  # .hexdigest() --> Converts raw byts into a hex string
  return hashlib.md5(file_content).hexdigest()

##############################################################################

# Scan File Function
# Intput --> File Path
# Output --> Return output print statement regarding the output of the 
# malicious hash checker
def scan_file(file_path):

  # Apply the input file path to a file hash under the variable
  # that is mentioned 'file_hash'
  file_hash = calculate_hash(file_path)

  # Check if the file hash is mentioned in the malicious_signature library
  if file_fash in malicious_signature:

    # Output warning statement if the hash is flagged
    print(f"[!] Warning: File {file_path} is flagged as malicious!")

  # Otherwise statement if the file hash isn't found in the malicious signature
  # library
  else:

    # Output statement if the file hash is clear from any malicious warnings
    print(f"[+] File {file_path} appears clean.")
    
##############################################################################

# Main Function
# Runs the file but will also check the file name applied to the 'file_to_scan'
# variable that is listed
def main():

  # Input file name to scan for malware or malicious hash signatures
  file_to_scan = "example.txt"

  # Run the file name into the scan file function
  scan_file(file_to_scan)

##############################################################################

# Run the file
if __name__ == "__main__":
  main()
